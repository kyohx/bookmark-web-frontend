# bookmark-web-frontend 仕様書

## 1. 概要
本アプリケーションは、ブックマークを管理するためのWebフロントエンドです。
ユーザーはログイン後、ブックマークの追加、編集、削除、タグによるフィルタリングを行うことができます。
「Premium」なデザインを意識し、ダークモードを基調としたモダンなUIを提供します。

## 2. 技術スタック
- **Framework**: React + Vite
- **Language**: TypeScript
- **Styling**: Vanilla CSS (CSS Variables, Global Styles)
- **Icons**: Lucide React
- **Routing**: React Router DOM

## 3. 画面構成

### 3.1 ログイン画面 (`/login`)
- **機能**:
    - ユーザー名とパスワードによる認証
    - ログイン成功時にアクセストークンを保存し、ダッシュボードへリダイレクト
- **デザイン**:
    - 中央配置のカードデザイン
    - ガラスモーフィズム効果（Glassmorphism）を採用

### 3.2 ダッシュボード画面 (`/`)
- **機能**:
    - ブックマーク一覧表示（カード形式）
    - ページネーション（1ページあたり12件）
    - タグによるフィルタリング（インクリメンタルサーチ）
    - 新規ブックマーク追加
    - 既存ブックマークの編集・削除
- **コンポーネント**:
    - **Navbar**: アプリケーションロゴとログアウトボタン
    - **BookmarkCard**: 各ブックマークの情報を表示（タイトル、URL、タグ、操作ボタン）
    - **BookmarkModal**: ブックマークの追加・編集用モーダル
    - **ConfirmModal**: 重要な操作（削除、保存）の確認用モーダル

## 4. 機能詳細

### 4.1 認証と権限管理 (`src/api/client.ts`)
- JWTベースの認証
- アクセストークンは `localStorage` に保存
- APIリクエスト時にAuthorizationヘッダーを付与
- 401エラー時に自動ログアウト処理

#### 4.1.1 権限レベル
ユーザーには以下の4つの権限レベルが設定されます:

| 権限レベル | 値 | 説明 | ブックマーク閲覧 | 追加/編集/削除 |
|-----------|---|------|----------------|---------------|
| 権限なし | 0 | アクセス不可 | ❌ | ❌ |
| 読み取り専用 | 1 | 閲覧のみ可能 | ✅ | ❌ |
| 読み書き可 | 2 | 全操作可能 | ✅ | ✅ |
| 管理者 | 9 | 全操作可能 | ✅ | ✅ |

**実装詳細**:
- `/me` エンドポイントからユーザー情報（`name`、`authority`）を取得
- `canEdit(authority: number)` 関数で権限チェック（`authority >= 2` の場合、編集可能）
- ダッシュボード初期化時にユーザー情報を取得し、権限に応じてUIを制御

### 4.2 ブックマーク管理
- **一覧取得**:
    - ページネーション対応
    - タグによる絞り込み
    - **権限**: すべてのユーザー（読み取り専用以上）が閲覧可能
- **追加**:
    - URL、Memo、Tagsを入力
    - 保存前に確認ダイアログを表示
    - **権限**: 読み書き可以上のユーザーのみ
    - **UI制御**: 読み取り専用ユーザーには「Add Bookmark」ボタンを非表示
- **編集**:
    - 一覧APIのレスポンスにはタグが含まれない場合があるため、編集開始時に詳細API (`GET /bookmarks/{id}`) をコールして完全なデータを取得
    - **制約**: 作成後のURL変更は不可（入力フィールドを無効化）
    - **タグ**: 編集ダイアログ表示時にアルファベット順にソートして表示
    - 保存前に確認ダイアログを表示
    - **権限**: 読み書き可以上のユーザーのみ
    - **UI制御**: 読み取り専用ユーザーには各ブックマークカードの編集ボタン（Edit）を非表示
- **削除**:
    - 削除ボタン押下時に確認ダイアログを表示（誤操作防止）
    - **権限**: 読み書き可以上のユーザーのみ
    - **UI制御**: 読み取り専用ユーザーには各ブックマークカードの削除ボタン（Delete）を非表示

### 4.3 確認ダイアログ (`ConfirmModal`)
- ブラウザ標準の `window.confirm` ではなく、Reactコンポーネントによるカスタムモーダルを使用
- **特徴**:
    - 削除時は赤色（Danger）、保存時は青色（Primary）のボタンを表示
    - モーダル外（背景）クリックでのキャンセル動作を適切に制御
    - ボタンのラベルを操作内容に応じて動的に変更（例: "Delete", "Save Changes", "Add"）

## 5. UI/UX デザイン
- **テーマ**: ダークモード
- **カラーパレット**:
    - Primary: Indigo (#6366f1)
    - Background: Dark Slate (#0f172a, #1e293b)
    - Text: White / Light Gray
- **インタラクション**:
    - ホバーエフェクト
    - トランジションアニメーション
    - 誤操作を防ぐための確認ステップ
